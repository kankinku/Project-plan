## Development Workflow & Definition of Done

- **문서 ID**: DOC-003
    
- **제목**: Development Workflow & DoD
    
- **버전**: 1.0
    
- **목표**: 기능 추가 시 “문서-스키마/로그-구현-테스트-재현성”이 같이 완성되도록 개발 절차와 완료 기준(DoD)을 고정한다.
    

---

## 1) 작업 순서(권장)

1. **문서 먼저**
    
    - 관련 DOC/SYS/PIPE/MOD 문서로 인터페이스·정책을 확정
        
2. **스키마/로그 계약 확정**
    
    - SCHEMA/OBS 변경이 있으면 validator 업데이트 포함
        
3. **구현**
    
    - 모듈 구현(MOD-*)
        
4. **테스트**
    
    - 단위 → 통합(E2E) → 회귀(재현성/룩어헤드)
        
5. **샘플 런**
    
    - 1 iteration 실행 + artifacts 생성 확인
        
6. **승격/배포**
    
    - 템플릿/제약/정책 버전 태깅(MOD-413/452, policy_version)
        

---

## 2) PR 체크리스트(최소 DoD)

-  관련 문서 업데이트(해당 DOC/SYS/PIPE/MOD 링크 포함)
    
-  스키마/로그 변경 시 validator 업데이트 및 샘플 JSON 추가
    
-  reason_code 추가 시 DOC-001 또는 해당 MOD 문서에 의미/조건 기록
    
-  단위 테스트 통과
    
-  통합 테스트(E2E 1 iteration) 통과
    
-  최소 아티팩트 생성 확인:
    
    -  OBS-530 (run metadata)
        
    -  OBS-540 (DQ checks)
        
    -  SCHEMA-340 (metrics)
        
    -  OBS-520 (trade summary)
        
-  재현성 확인(가능 범위 내):
    
    - 동일 seed/data/version → 동일 strategy_id
        
    - 동일 입력 → metrics 허용오차 내 일치
        

---

## 3) 최소 테스트 세트(초기 권장)

- **TEST-600**: E2E 1 iteration(생성→A→스코어→B→로그/메트릭 저장)
    
- **TEST-610**: 결정성/재현성(동일 입력 → 동일 ID/유사 metrics)
    
- **TEST-630**: 룩어헤드/체결 타이밍 위반 탐지(next_bar 준수)
    
- **TEST-650**: 로그 조인 키 무결성(run/iter/strategy/order/trade)
    

---

## 4) 버전업 정책

### 4.1 스키마/정규화/해시 변경

- 호환성 파괴 가능성이 높음 → 반드시:
    
    - 문서 버전 증가
        
    - 영향 범위(기존 결과 재계산 필요 여부) 명시
        
    - 회귀 테스트 추가/수정
        

### 4.2 scoring 정책 변경

- `policy_version`을 반드시 변경(예: `score_v2`)
    
- 과거 결과와 비교 가능하도록:
    
    - 기존 policy도 유지(재계산 가능하게)
        

### 4.3 모델 변경(cost/execution/portfolio)

- 각각 `*_model_version` 문자열 증가
    
- 변경 내용 요약 + 대표 전략 3개로 회귀 비교 권장
    

---

## 5) 운영 모드 안전 규칙(개발 단계부터 강제 권장)

- 기본 모드는 `backtest`
    
- `paper/live`는 명시적으로 enable되지 않으면 절대 실행되지 않음(가드)
    
- `live`는 반드시:
    
    - idempotency(client_order_id)
        
    - Risk Guard(손실한도/이상징후) 활성
        
    - secrets 마스킹  
        를 만족해야 함
        

---

## 6) 수용 기준(프로젝트 레벨)

- “검증(backtest B)”에 올라간 전략은:
    
    - OBS-500/510/520 풀로그 생성(정책상 예외가 있으면 이유 기록)
        
    - DQ 체크(OBS-540) CRITICAL 없음
        
    - calc_contract가 metrics에 포함(SCHEMA-340)
        

---
