# SYS-100 — System Overview

- **문서 ID**: SYS-100
    
- **제목**: System Overview
    
- **버전**: 1.0
    
- **목표**: 데이터 기반으로 전략을 생성→평가→수정하는 에이전트를 “완전 자동매매”까지 확장 가능하게 설계하되, 실패 시 **관측 가능성(Observability)·재현성(Reproducibility)·설명 가능성(Explainability)** 이 유지되도록 시스템 경계와 흐름을 정의한다.
    

---

## 1) 시스템 구성요소(Components)

- **Orchestrator**: MOD-400
    
- **Run/Iteration/Strategy ID 정책**: MOD-401
    
- **Strategy Generator**: MOD-410~413
    
- **Backtester (공통 인터페이스)**: MOD-420
    
    - Engine A(탐색, vectorized): MOD-421
        
    - Engine B(검증, event-driven): MOD-422
        
    - Cost Model: MOD-423
        
    - Execution Model: MOD-424
        
    - Portfolio Model: MOD-425
        
- **Metrics/Score/Report**
    
    - Metrics: MOD-430
        
    - Scorer: MOD-431
        
    - Robustness: MOD-432
        
    - Report: MOD-433
        
- **Root-cause Analyzer**: MOD-440~442
    
- **Constraints**: MOD-450~452
    
- **Knowledge Base**: MOD-460~462
    
- **Scenario Intake (V2)**: MOD-470~472
    
- **Live Trading**: MOD-480~483
    

---

## 2) End-to-End 데이터 흐름(Flow)

### 2.1 기본 루프(Iteration)

1. (옵션) **Scenario 입력**: NL → JSON (MOD-470)
    
2. **전략 후보 생성**: MOD-410(+MOD-411)
    
3. **정규화/해시/중복 제거**: MOD-412
    
4. **DQ 체크(필수 권장)**: OBS-540 (데이터/룩어헤드/캘린더/유니버스)
    
5. **탐색 백테스트 A**: MOD-421 → SCHEMA-340 (빠른 랭킹)
    
6. **스코어링**: MOD-431 → shortlist
    
7. **검증 백테스트 B**: MOD-422 → OBS-500/510/520 + SCHEMA-340
    
8. **원인 분석/근거 생성**: MOD-440~442
    
9. **실패→제약 변환/주입**: MOD-450~451
    
10. **지식 축적**: MOD-460~462
    
11. 다음 iteration 또는 종료(MOD-400 정책)
    

---

## 3) 핵심 시스템 정책(Principles)

### 3.1 재현성(Reproducibility)

- 동일한 **data snapshot + code commit + seed + policy version**이면:
    
    - 동일 `strategy_id`(MOD-401/412)
        
    - 결과는 허용오차 내에서 재현 가능(Engine 차이는 정책으로 관리)
        
- run 단위 메타는 **OBS-530**로 고정 저장
    

### 3.2 룩어헤드 방지(필수)

- 기본 체결 타이밍: `execution_timing = next_bar`
    
- 예외(동일 바 체결 허용)는 정책으로 명시하고 **DQ에서 WARN/FAIL** 처리(OBS-540)
    

### 3.3 2단 평가(Exploration vs Verification)

- Engine A: 빠르게 “가능성 있는 후보”를 넓게 탐색
    
- Engine B: 현실 실행·로그·제약을 포함해 “신뢰 가능한 후보”로 좁힘
    

### 3.4 실패의 제약화(탐색 공간 축소)

- 낮은 성적/에러는 “원인 분석 → 로그/증거 → 제약으로 변환” 흐름을 탄다.
    
- 목표: 같은 실수를 반복하지 않도록 **생성 경우의 수를 줄이는 방향**으로 수렴
    

### 3.5 관측 가능성(증거 중심)

- 최소 산출물:
    
    - OBS-530(run metadata)
        
    - OBS-540(DQ checks)
        
    - OBS-520(trade summary)
        
    - SCHEMA-340(metrics)
        
- 검증 단계(shortlist 이상)에서는:
    
    - OBS-500/510/520 풀 로그를 기본으로 생성(정책상 예외 시 사유 기록)
        

---

## 4) 주요 입력/출력(Contracts)

### 4.1 입력

- Strategy DSL/AST: SCHEMA-300/310
    
- Constraints: SCHEMA-330
    
- Metrics Contract: SCHEMA-340(calc_contract)
    
- Scenario (옵션): MOD-470 출력 JSON
    

### 4.2 출력(Artifacts)

- **전략 후보/선정 결과**: candidates.jsonl / shortlist.jsonl
    
- **메트릭**: SCHEMA-340 전략별 JSON
    
- **관측 로그**: OBS-500/510/520/530/540
    
- **분석/리포트**: MOD-433 산출물
    
- **지식 베이스 축적물**: MOD-460/461
    

---

## 5) 실패 분류(시스템 레벨)

(후속 MOD-440에서 상세화되지만, SYS 레벨에서 카테고리만 고정)

- Signal Failure
    
- Timing Failure
    
- Risk Model Failure
    
- Execution Failure
    
- Portfolio Failure
    
- Data Failure
    
- Infrastructure Failure
    

---

## 6) 운영 모드(Backtest / Paper / Live)

- 기본: backtest
    
- paper/live는 “명시적 enable + 안전장치 통과”가 없으면 실행 불가(SYS-130 연동)
    
- live에서는:
    
    - Broker Adapter(MOD-480) + OMS(MOD-481) + Risk Guard(MOD-482) + Replay(MOD-483)
        

---

## 7) 수용 기준(Acceptance Criteria)

- E2E 1 iteration이 다음을 만족:
    
    - strategy_id 생성/중복 제거 정상(MOD-412)
        
    - Engine A 메트릭 산출(SCHEMA-340)
        
    - shortlist 전략은 Engine B로 검증 + OBS 풀로그 산출
        
    - DQ 체크(OBS-540) 저장
        
    - run 메타(OBS-530) 저장
        

---

## 8) 테스트(시스템 레벨)

- TEST-600: E2E 1 iteration
    
- TEST-610: 재현성(동일 seed/data/version)
    
- TEST-630: 룩어헤드/체결 타이밍 위반 탐지
    
- TEST-650: 로그 조인 키 무결성
    

---
